{
  "version": "1.0.0",
  "description": "Automated security scanning triggers and workflows",
  "triggers": [
    {
      "name": "scan_new_typescript_files",
      "description": "Automatically scan new TypeScript files for credentials",
      "event": "file_created",
      "filePattern": "**/*.ts",
      "exclude": [
        "node_modules/**",
        "build/**",
        "dist/**",
        "tests/fixtures/**"
      ],
      "actions": [
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_credentials",
          "params": {
            "mode": "file",
            "minConfidence": 0.7
          },
          "on_violation": "warn"
        }
      ],
      "enabled": true
    },
    {
      "name": "scan_config_files",
      "description": "Scan configuration files for exposed secrets",
      "event": "file_modified",
      "filePattern": "**/{.env*,config.*,*.config.{js,ts,json}}",
      "exclude": [
        "node_modules/**"
      ],
      "actions": [
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_credentials",
          "params": {
            "mode": "file",
            "minConfidence": 0.8
          },
          "on_violation": "block"
        }
      ],
      "enabled": true
    },
    {
      "name": "scan_patient_data_files",
      "description": "Scan files with patient data for PHI exposure",
      "event": "file_modified",
      "filePattern": "**/patient*/**/*.{ts,js,json}",
      "actions": [
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_phi",
          "params": {
            "mode": "file",
            "sensitivity": "high",
            "categories": [
              "identifier",
              "demographic",
              "medical"
            ]
          },
          "on_violation": "block"
        }
      ],
      "enabled": true
    },
    {
      "name": "scan_medical_records",
      "description": "High-sensitivity PHI scanning for medical records",
      "event": "file_modified",
      "filePattern": "**/medical-records/**/*",
      "actions": [
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_phi",
          "params": {
            "mode": "file",
            "sensitivity": "high"
          },
          "on_violation": "block"
        }
      ],
      "enabled": true
    },
    {
      "name": "pre_commit_security_check",
      "description": "Run security checks before git commits",
      "event": "pre_commit",
      "actions": [
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_credentials",
          "params": {
            "mode": "staged"
          },
          "on_violation": "block"
        },
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_phi",
          "params": {
            "mode": "staged",
            "sensitivity": "medium"
          },
          "on_violation": "block"
        }
      ],
      "enabled": true
    },
    {
      "name": "pre_pr_full_scan",
      "description": "Comprehensive security scan before creating pull requests",
      "event": "pr_created",
      "actions": [
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_credentials",
          "params": {
            "mode": "directory",
            "target": "./src",
            "exclude": [
              "node_modules",
              "build",
              "dist"
            ]
          },
          "on_violation": "block"
        },
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_phi",
          "params": {
            "mode": "directory",
            "target": "./src",
            "sensitivity": "high"
          },
          "on_violation": "block"
        }
      ],
      "enabled": true
    },
    {
      "name": "weekly_codebase_audit",
      "description": "Weekly comprehensive security audit",
      "event": "scheduled",
      "schedule": "0 0 * * 1",
      "actions": [
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_credentials",
          "params": {
            "mode": "directory",
            "target": "."
          },
          "on_violation": "warn"
        },
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "scan_for_phi",
          "params": {
            "mode": "directory",
            "target": ".",
            "sensitivity": "medium"
          },
          "on_violation": "warn"
        },
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "manage_secrets",
          "params": {
            "action": "status"
          }
        }
      ],
      "enabled": true
    },
    {
      "name": "daily_secret_rotation_check",
      "description": "Daily check for secrets needing rotation",
      "event": "scheduled",
      "schedule": "0 9 * * *",
      "actions": [
        {
          "mcp_server": "security-compliance-mcp",
          "tool": "manage_secrets",
          "params": {
            "action": "status"
          },
          "alert_on": [
            "expiring",
            "expired"
          ]
        }
      ],
      "enabled": true
    }
  ],
  "notifications": {
    "onViolation": {
      "enabled": true,
      "channels": [
        "log",
        "audit"
      ],
      "severity_threshold": "high"
    },
    "onSecretRotation": {
      "enabled": true,
      "channels": [
        "log"
      ],
      "warning_days": 7
    },
    "onPHIAccess": {
      "enabled": true,
      "channels": [
        "audit"
      ],
      "track_all": true
    }
  },
  "compliance": {
    "hipaa": {
      "enabled": true,
      "audit_retention_days": 2190,
      "phi_tracking": true
    },
    "reporting": {
      "monthly_audit": true,
      "quarterly_review": true
    }
  }
}
